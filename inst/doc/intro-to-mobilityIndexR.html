<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Introduction to mobilityIndexR</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to mobilityIndexR</h1>



<p>This vignette provides a guide for using the <code>mobilityIndexR</code> package. <code>mobilityIndexR</code> allows users to both calculate transition matrices (relative, mixed, and absolute) as well as calculate and compare mobility indices (<em>Prais-Bibby</em>, <em>Average Movement</em>, <em>Weighted Group Mobility</em>, and <em>Origin Specific</em>). Below are examples and brief explanations of each.</p>
<div id="transition-matrices" class="section level1">
<h1>Transition Matrices</h1>
<p>Two dimensional transition matrices are a tool for representing mobility within a group between two points in time with respect to some observable value such as income of workers or grades of students. Generally, this approach in some way ranks the observable value at each point in time and displays a contingency table with aggregated counts or proportions of each combination of ranks. <code>mobilityIndexR</code> offers three methods of constructing ranks using the <code>getTMatrix</code> function: relative, mixed, and absolute.</p>
<p>As example data, we include three datasets: <code>mobilityIndexR::incomeMobility</code>, <code>mobilityIndexR::incomeZeroInfMobility</code>, and <code>mobilityIndexR::gradeMobility</code>. These datasets each contain 125 records, an “id” column, and observations of some value at ten points in time, denoted “t0”, …, “t9”. <code>mobilityIndexR::incomeMobility</code> simulates income data over ten years; <code>mobilityIndexR::incomeZeroInfMobility</code> simulates income data over ten years that has an inflated number of zeros; and <code>mobilityIndexR::gradeMobility</code> simulates student grade data over ten assignments.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">head</span>(incomeMobility)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co">#&gt;     id cohort    t0       t1       t2       t3       t4       t5        t6</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co">#&gt; 1 1001   2003 39235 39132.26 38988.60 23614.84 23629.59 23981.55  24032.27</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">#&gt; 2 1002   2001 42533 70862.75 69655.04 70187.41 42896.49 42434.42  42790.18</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">#&gt; 3 1003   2002 81463 81950.41 49711.08 49542.85 49628.86 82498.21 133827.51</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">#&gt; 4 1004   2004 34363 33788.56 33744.43 33556.58 33658.70 20477.59  19994.63</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">#&gt; 5 1005   2000 96627 97232.96 96614.23 95153.38 57226.46 57846.22  57361.49</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">#&gt; 6 1006   2000 81552 81219.28 80966.39 81258.77 80573.05 79874.92  79569.12</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co">#&gt;          t7        t8        t9       t10</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co">#&gt; 1  39364.19  64585.58  64018.87  63758.16</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co">#&gt; 2  71126.93  71197.74 117711.75 116259.49</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co">#&gt; 3 133013.99 133126.18  80077.67  80559.27</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co">#&gt; 4  19939.64  19850.30  19869.06  31870.81</span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="co">#&gt; 5  94513.92  95099.74  94393.98  93521.19</span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="co">#&gt; 6  79847.03  80492.59  80553.66  80703.09</span></span></code></pre></div>
<div id="relative" class="section level2">
<h2>Relative</h2>
<p>Types of transition matrices differ by how values are binned into ranks. With relative transition matrices, values in each of the two specified columns (<code>col_x</code>, <code>col_y</code>) are binned into ranks as quantiles. The number of quantiles is specified in the <code>num_ranks</code> argument. Note: if one value in the data occurs more often than the size of the quantile ranks, then <code>getTMatrix</code> will throw an error; see <a href="#exclude-value">Exclude Value</a>.</p>
<p><code>getTMatrix</code> returns a list containing the transition matrix as well as the bounds used to bin the data into ranks.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">getTMatrix</span>(<span class="dt">dat =</span> incomeMobility, <span class="dt">col_x =</span> <span class="st">&quot;t0&quot;</span>, <span class="dt">col_y =</span> <span class="st">&quot;t5&quot;</span>, </span>
<span id="cb2-2"><a href="#cb2-2"></a>           <span class="dt">type =</span> <span class="st">&quot;relative&quot;</span>, <span class="dt">num_ranks =</span> <span class="dv">5</span>, <span class="dt">probs =</span> <span class="ot">FALSE</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">#&gt; $tmatrix</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">#&gt;    </span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">#&gt;      1  2  3  4  5</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co">#&gt;   1 19  5  1  0  0</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">#&gt;   2  6 10  6  3  0</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">#&gt;   3  0  6  8  7  4</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co">#&gt;   4  0  1  3 15  6</span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co">#&gt;   5  0  3  7  0 15</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co">#&gt; </span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="co">#&gt; $col_x_bounds</span></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co">#&gt;      0%     20%     40%     60%     80%    100% </span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="co">#&gt;   462.0 21543.4 42469.8 64061.6 77888.4 99557.0 </span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="co">#&gt; </span></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="co">#&gt; $col_y_bounds</span></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="co">#&gt;          0%         20%         40%         60%         80%        100% </span></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co">#&gt;    340.2705  18204.9969  39710.3062  58494.6271  78178.6713 262909.3195</span></span></code></pre></div>
<p>The above example produces a <span class="math inline">\(5 \times 5\)</span> contingency table. Setting the argument <code>probs = TRUE</code>, we obtain a transition matrix with unconditional probabilities rather than counts.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">getTMatrix</span>(<span class="dt">dat =</span> incomeMobility, <span class="dt">col_x =</span> <span class="st">&quot;t0&quot;</span>, <span class="dt">col_y =</span> <span class="st">&quot;t5&quot;</span>, </span>
<span id="cb3-2"><a href="#cb3-2"></a>           <span class="dt">type =</span> <span class="st">&quot;relative&quot;</span>, <span class="dt">num_ranks =</span> <span class="dv">5</span>, <span class="dt">probs =</span> <span class="ot">TRUE</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">#&gt; $tmatrix</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">#&gt;    </span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">#&gt;         1     2     3     4     5</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co">#&gt;   1 0.152 0.040 0.008 0.000 0.000</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">#&gt;   2 0.048 0.080 0.048 0.024 0.000</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co">#&gt;   3 0.000 0.048 0.064 0.056 0.032</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co">#&gt;   4 0.000 0.008 0.024 0.120 0.048</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co">#&gt;   5 0.000 0.024 0.056 0.000 0.120</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co">#&gt; </span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co">#&gt; $col_x_bounds</span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="co">#&gt;      0%     20%     40%     60%     80%    100% </span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="co">#&gt;   462.0 21543.4 42469.8 64061.6 77888.4 99557.0 </span></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="co">#&gt; </span></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="co">#&gt; $col_y_bounds</span></span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="co">#&gt;          0%         20%         40%         60%         80%        100% </span></span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="co">#&gt;    340.2705  18204.9969  39710.3062  58494.6271  78178.6713 262909.3195</span></span></code></pre></div>
</div>
<div id="mixed" class="section level2">
<h2>Mixed</h2>
<p>With mixed transition matrices, values in <code>col_x</code> are first binned into ranks as quantiles, then the bounds for <code>col_x</code> are used to bin <code>col_y</code> into ranks. In the example below, observe that <code>col_x_bounds</code> and <code>col_y_bounds</code> are equal except for the minimum and maximum values.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">getTMatrix</span>(<span class="dt">dat =</span> incomeMobility, <span class="dt">col_x =</span> <span class="st">&quot;t0&quot;</span>, <span class="dt">col_y =</span> <span class="st">&quot;t5&quot;</span>, </span>
<span id="cb4-2"><a href="#cb4-2"></a>           <span class="dt">type =</span> <span class="st">&quot;mixed&quot;</span>, <span class="dt">num_ranks =</span> <span class="dv">5</span>, <span class="dt">probs =</span> <span class="ot">FALSE</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">#&gt; $tmatrix</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">#&gt;    </span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co">#&gt;      1  2  3  4  5</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co">#&gt;   1 21  3  1  0  0</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co">#&gt;   2  8 11  4  2  0</span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">#&gt;   3  1  6 13  1  4</span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co">#&gt;   4  0  2  2 15  6</span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co">#&gt;   5  1  2  7  0 15</span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co">#&gt; </span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co">#&gt; $col_x_bounds</span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co">#&gt;      0%     20%     40%     60%     80%    100% </span></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="co">#&gt;   461.0 21543.4 42469.8 64061.6 77888.4 99558.0 </span></span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="co">#&gt; </span></span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="co">#&gt; $col_y_bounds</span></span>
<span id="cb4-17"><a href="#cb4-17"></a><span class="co">#&gt;          0%         20%         40%         60%         80%        100% </span></span>
<span id="cb4-18"><a href="#cb4-18"></a><span class="co">#&gt;    339.2705  21543.4000  42469.8000  64061.6000  77888.4000 262910.3195</span></span></code></pre></div>
</div>
<div id="absolute" class="section level2">
<h2>Absolute</h2>
<p>With absolute transition matrices, values in <code>col_x</code> and <code>col_y</code> are binned into ranks using user-specified bounds with the <code>bounds</code> argument.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">getTMatrix</span>(<span class="dt">dat =</span> gradeMobility, <span class="dt">col_x =</span> <span class="st">&quot;t0&quot;</span>, <span class="dt">col_y =</span> <span class="st">&quot;t5&quot;</span>, </span>
<span id="cb5-2"><a href="#cb5-2"></a>           <span class="dt">type =</span> <span class="st">&quot;absolute&quot;</span>, <span class="dt">probs =</span> <span class="ot">FALSE</span>, <span class="dt">bounds =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">1.0</span>))</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">#&gt; $tmatrix</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">#&gt;    </span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">#&gt;      1  2  3  4  5</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">#&gt;   1 10  3  0  0  0</span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">#&gt;   2  6 13  8  0  0</span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">#&gt;   3  0 12 17  8  3</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co">#&gt;   4  0  3 13 11 13</span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co">#&gt;   5  0  0  1  0  4</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="co">#&gt; </span></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co">#&gt; $col_x_bounds</span></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="co">#&gt; [1] 0.0 0.6 0.7 0.8 0.9 1.0</span></span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="co">#&gt; </span></span>
<span id="cb5-15"><a href="#cb5-15"></a><span class="co">#&gt; $col_y_bounds</span></span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="co">#&gt; [1] 0.0 0.6 0.7 0.8 0.9 1.0</span></span></code></pre></div>
</div>
</div>
<div id="mobility-indices" class="section level1">
<h1>Mobility Indices</h1>
<p>Mobility indices are measures of mobility within a group between two points in time with respect to some observable value such as income of workers or grades of students. <code>mobilityIndexR</code> calculates indices using the <code>getMobilityIndices</code> function. By default, the <code>getMobilityIndices</code> returns all available indices. Note that <code>getMobilityIndices</code> can additionally return bootstrapped intervals for each of the indices; see <a href="#bootstrapped-intervals">Bootstrapped Intervals</a>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">getMobilityIndices</span>(<span class="dt">dat =</span> incomeMobility, <span class="dt">col_x =</span> <span class="st">&quot;t0&quot;</span>, <span class="dt">col_y =</span> <span class="st">&quot;t5&quot;</span>, </span>
<span id="cb6-2"><a href="#cb6-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;relative&quot;</span>, <span class="dt">num_ranks =</span> <span class="dv">5</span>)</span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">#&gt; $average_movement</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">#&gt; [1] 0.64</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">#&gt; </span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co">#&gt; $os_far_bottom</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co">#&gt; [1] 0.04</span></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co">#&gt; </span></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="co">#&gt; $os_far_top</span></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="co">#&gt; [1] 0.4</span></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="co">#&gt; </span></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="co">#&gt; $os_total_bottom</span></span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="co">#&gt; [1] 0.24</span></span>
<span id="cb6-14"><a href="#cb6-14"></a><span class="co">#&gt; </span></span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="co">#&gt; $os_total_top</span></span>
<span id="cb6-16"><a href="#cb6-16"></a><span class="co">#&gt; [1] 0.4</span></span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="co">#&gt; </span></span>
<span id="cb6-18"><a href="#cb6-18"></a><span class="co">#&gt; $prais_bibby</span></span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="co">#&gt; [1] 0.464</span></span>
<span id="cb6-20"><a href="#cb6-20"></a><span class="co">#&gt; </span></span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="co">#&gt; $wgm</span></span>
<span id="cb6-22"><a href="#cb6-22"></a><span class="co">#&gt; [1] 0.58</span></span></code></pre></div>
<p>Below is a brief description of the indices. Let <span class="math inline">\(s(i)\)</span> be the event that one is in rank <span class="math inline">\(i\)</span> at the first or starting point in time and <span class="math inline">\(e(j)\)</span> be the event that one is in rank <span class="math inline">\(j\)</span> at the second or ending point in time. Suppose <span class="math inline">\(k\)</span> is the largest rank in the data.</p>
<p>The <em>Prais-Bibby</em> index (<code>type = &quot;prais_bibby&quot;</code>) is the proportion of records that change ranks, i.e. <span class="math inline">\(\Sigma_{i = 1}^kPr[s(i) \neq e(i)]\)</span>.</p>
<p>The <em>Average Mobility</em> index (<code>type = &quot;average_movement&quot;</code>) is the average number of ranks records move.</p>
<p>The <em>Weighted Group Mobility</em> index (<code>type = &quot;wgm&quot;</code>) is a weighted version of the proportion of records that change ranks, i.e. <span class="math inline">\(k^{-1} \Sigma_{i = 1}^k \frac{Pr[\neg e(i) | s(i)]}{Pr[\neg e(i)]}\)</span>.</p>
<p>There are four <em>Origin Specific</em> indices (<code>type = &quot;origin_specific&quot;</code>): top, bottom, top far, and bottom far. The top (bottom) index is the proportion of records that begin in the top (bottom) and end outside of the top (bottom). The far versions of these indices are the proportions of records that begin in the top (bottom) and end at least two ranks away from the top (bottom).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">getMobilityIndices</span>(<span class="dt">dat =</span> incomeMobility, <span class="dt">col_x =</span> <span class="st">&quot;t0&quot;</span>, <span class="dt">col_y =</span> <span class="st">&quot;t5&quot;</span>, </span>
<span id="cb7-2"><a href="#cb7-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;relative&quot;</span>, <span class="dt">num_ranks =</span> <span class="dv">5</span>, <span class="dt">indices =</span> <span class="st">&quot;wgm&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co">#&gt; $wgm</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co">#&gt; [1] 0.58</span></span></code></pre></div>
<p>A single index or subset of the indices can be returned by passing a string or vector of strings in the <code>indices</code> argument.</p>
</div>
<div id="hypothesis-testing" class="section level1">
<h1>Hypothesis Testing</h1>
<p>The function <code>getHypothesisTest</code> compares mobility indices across datasets. The user specifies two datasets (<code>dat_A</code>, <code>dat_B</code>) as well as a pair of columns from each dataset as a vector (<code>cols_A</code>, <code>cols_B</code>). This function performs a non-parametric one-sided hypothesis test that the index value for <code>dat_A</code> is greater than the index value for <code>dat_B</code>. The parameter <code>bootstrap_iter</code> specifies the number of bootstrap iterations; the default value is <code>100</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">getHypothesisTest</span>(<span class="dt">dat_A =</span> incomeMobility, <span class="dt">dat_B =</span> incomeMobility, </span>
<span id="cb8-2"><a href="#cb8-2"></a>                  <span class="dt">cols_A =</span> <span class="kw">c</span>(<span class="st">&quot;t0&quot;</span>, <span class="st">&quot;t3&quot;</span>), <span class="dt">cols_B =</span> <span class="kw">c</span>(<span class="st">&quot;t5&quot;</span>, <span class="st">&quot;t8&quot;</span>),</span>
<span id="cb8-3"><a href="#cb8-3"></a>                  <span class="dt">type =</span> <span class="st">&quot;relative&quot;</span>, <span class="dt">num_ranks =</span> <span class="dv">5</span>, <span class="dt">bootstrap_iter =</span> <span class="dv">100</span>)</span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co">#&gt; $prais_bibby</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co">#&gt; [1] 0.38</span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co">#&gt; </span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co">#&gt; $average_movement</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co">#&gt; [1] 0.6</span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co">#&gt; </span></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="co">#&gt; $wgm</span></span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="co">#&gt; [1] 0.39</span></span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="co">#&gt; </span></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="co">#&gt; $os_total_top</span></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="co">#&gt; [1] 0.51</span></span>
<span id="cb8-15"><a href="#cb8-15"></a><span class="co">#&gt; </span></span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="co">#&gt; $os_far_top</span></span>
<span id="cb8-17"><a href="#cb8-17"></a><span class="co">#&gt; [1] 0.92</span></span>
<span id="cb8-18"><a href="#cb8-18"></a><span class="co">#&gt; </span></span>
<span id="cb8-19"><a href="#cb8-19"></a><span class="co">#&gt; $os_total_bottom</span></span>
<span id="cb8-20"><a href="#cb8-20"></a><span class="co">#&gt; [1] 0.32</span></span>
<span id="cb8-21"><a href="#cb8-21"></a><span class="co">#&gt; </span></span>
<span id="cb8-22"><a href="#cb8-22"></a><span class="co">#&gt; $os_far_bottom</span></span>
<span id="cb8-23"><a href="#cb8-23"></a><span class="co">#&gt; [1] 0.03</span></span></code></pre></div>
<p>By default, all available indices are returned. A single index or subset of the indices can be returned by passing a string or vector of strings in the <code>indices</code> argument.</p>
</div>
<div id="advanced-options" class="section level1">
<h1>Advanced Options</h1>
<div id="bootstrapped-intervals" class="section level2">
<h2>Bootstrapped Intervals</h2>
<p>The function <code>getMobilityIndices</code> produces non-parametric bootstrapped confidence intervals using the percentile method by setting <code>intervals = TRUE</code>. By default, <code>intervals = FALSE</code>. The parameter <code>interval_pct</code> specifies the size of the confidence interval in terms of the proportion of the data covered; the default value is <code>0.95</code>. The parameter <code>bootstrap_iter</code> specifies the number of bootstrap iterations; the default value is <code>100</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">getMobilityIndices</span>(<span class="dt">dat =</span> incomeMobility, <span class="dt">col_x =</span> <span class="st">&quot;t0&quot;</span>, <span class="dt">col_y =</span> <span class="st">&quot;t5&quot;</span>, </span>
<span id="cb9-2"><a href="#cb9-2"></a>                   <span class="dt">type =</span> <span class="st">&quot;relative&quot;</span>, <span class="dt">num_ranks =</span> <span class="dv">5</span>, <span class="dt">indices =</span> <span class="st">&quot;wgm&quot;</span>,</span>
<span id="cb9-3"><a href="#cb9-3"></a>                   <span class="dt">intervals =</span> <span class="ot">TRUE</span>, <span class="dt">interval_pct =</span> <span class="fl">0.95</span>, <span class="dt">bootstrap_iter =</span> <span class="dv">100</span>)</span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">#&gt; $wgm</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co">#&gt; [1] 0.58</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">#&gt; </span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">#&gt; $wgm_intervals</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">#&gt; $wgm_intervals$lower</span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">#&gt;      2.5% </span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">#&gt; 0.4250779 </span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co">#&gt; </span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co">#&gt; $wgm_intervals$upper</span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co">#&gt;     97.5% </span></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co">#&gt; 0.7296108 </span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="co">#&gt; </span></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co">#&gt; $wgm_intervals$interval_bounds</span></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="co">#&gt; [1] 0.025 0.975</span></span></code></pre></div>
</div>
<div id="exclude-value" class="section level2">
<h2>Exclude Value</h2>
<p>For <code>type = &quot;relative&quot;</code> or <code>type = &quot;mixed&quot;</code>, if one value in the data occurs more often than the size of the ranks then an error will result. This error will occur with <code>getTMatrix</code>, <code>getMobilityIndices</code>, and <code>getHypothesisTest</code> since binning into quantile ranks is not well defined in this case. See the example below where <span class="math inline">\(0\)</span> makes up more than <span class="math inline">\(20\%\)</span> of the values in the “t0” column.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">getTMatrix</span>(<span class="dt">dat =</span> incomeZeroInfMobility, <span class="dt">col_x =</span> <span class="st">&quot;t0&quot;</span>, <span class="dt">col_y =</span> <span class="st">&quot;t5&quot;</span>,</span>
<span id="cb10-2"><a href="#cb10-2"></a>           <span class="dt">type =</span> <span class="st">&quot;relative&quot;</span>, <span class="dt">num_ranks =</span> <span class="dv">5</span>, <span class="dt">probs =</span> <span class="ot">FALSE</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="co">#&gt; Error in checkTooManyRanks(df = df, col_in = col_in, num_ranks = num_ranks, : One of the values represents more than 0.2 of the data. Try using fewer ranks or setting strict to FALSE.</span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="kw">table</span>(incomeZeroInfMobility<span class="op">$</span>t0)</span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="co">#&gt; </span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">#&gt;     0  1701  3009  8528 12094 12900 13404 13636 20507 25257 25698 27887 28486 </span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">#&gt;    61     1     1     1     1     1     1     1     1     1     1     1     1 </span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co">#&gt; 29316 29558 29961 30216 31460 32665 32789 35269 37638 38635 39021 40496 41443 </span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">#&gt;     1     1     1     1     1     1     1     1     1     1     1     1     1 </span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co">#&gt; 45106 45500 47188 47776 51703 52084 55799 56134 59943 60689 61592 63729 64877 </span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="co">#&gt;     1     1     1     1     1     1     1     1     1     1     1     1     1 </span></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="co">#&gt; 66356 67509 68428 68683 72093 72611 74418 76879 77174 78929 80121 80562 82322 </span></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="co">#&gt;     1     1     1     1     1     1     1     1     1     1     1     1     1 </span></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="co">#&gt; 85666 85932 90068 90668 93007 96565 97100 97143 97907 98537 98768 98771 99406 </span></span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="co">#&gt;     1     1     1     1     1     1     1     1     1     1     1     1     1</span></span></code></pre></div>
<p>One approach is to bin some elements of the problematic value in one rank and the others in another rank. This is done by setting the parameter <code>strict = FALSE</code>. By default, <code>strict = TRUE</code>. This setting adds a negligible amount of random noise to the problematic values to make binning the values into quantile ranks well defined.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">getTMatrix</span>(<span class="dt">dat =</span> incomeZeroInfMobility, <span class="dt">col_x =</span> <span class="st">&quot;t0&quot;</span>, <span class="dt">col_y =</span> <span class="st">&quot;t5&quot;</span>,</span>
<span id="cb11-2"><a href="#cb11-2"></a>           <span class="dt">type =</span> <span class="st">&quot;relative&quot;</span>, <span class="dt">num_ranks =</span> <span class="dv">5</span>, <span class="dt">probs =</span> <span class="ot">FALSE</span>, <span class="dt">strict =</span> <span class="ot">FALSE</span>)</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">#&gt; $tmatrix</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">#&gt;    </span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co">#&gt;      1  2  3  4  5</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co">#&gt;   1  6  8  7  4  0</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co">#&gt;   2  4  6 12  3  0</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co">#&gt;   3  6  8  4  7  0</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co">#&gt;   4  3  2  0 10 10</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co">#&gt;   5  6  1  2  1 15</span></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co">#&gt; </span></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="co">#&gt; $col_x_bounds</span></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="co">#&gt;      0%     20%     40%     60%     80%    100% </span></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="co">#&gt;     0.0     0.0     0.0 29719.2 66586.6 99406.0 </span></span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="co">#&gt; </span></span>
<span id="cb11-16"><a href="#cb11-16"></a><span class="co">#&gt; $col_y_bounds</span></span>
<span id="cb11-17"><a href="#cb11-17"></a><span class="co">#&gt;        0%       20%       40%       60%       80%      100% </span></span>
<span id="cb11-18"><a href="#cb11-18"></a><span class="co">#&gt;      0.00   2899.76  14254.91  25601.36  44479.91 121396.47</span></span></code></pre></div>
<p>A second approach is to exclude the problematic value from binning the values into quantile ranks then either give the problematic value its own rank, add the problematic value to an existing rank, or exclude the problematic value altogether. A problematic value can be specified in the <code>exclude_value</code> argument. Note: currently, <code>mobilityIndexR</code> only supports one exclude value.</p>
<p>If an exclude value is specified, the user must also specify how to handle the exclude value using the <code>rerank_exclude_value</code> parameter. Setting <code>rerank_exclude_value = &quot;as_new_rank&quot;</code> creates an new rank for the exclude value and modifies the other ranks to remain ordinally consistent. Setting <code>rerank_exclude_value = &quot;as_existing_rank&quot;</code> bins the exclude value into an existing rank. Setting <code>rerank_exclude_value = &quot;exclude&quot;</code> drops any row that has the exclude value from the calculation.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">getTMatrix</span>(<span class="dt">dat =</span> incomeZeroInfMobility, <span class="dt">col_x =</span> <span class="st">&quot;t0&quot;</span>, <span class="dt">col_y =</span> <span class="st">&quot;t5&quot;</span>,</span>
<span id="cb12-2"><a href="#cb12-2"></a>           <span class="dt">type =</span> <span class="st">&quot;relative&quot;</span>, <span class="dt">num_ranks =</span> <span class="dv">5</span>, <span class="dt">probs =</span> <span class="ot">FALSE</span>,</span>
<span id="cb12-3"><a href="#cb12-3"></a>           <span class="dt">exclude_value =</span> <span class="dv">0</span>, <span class="dt">rerank_exclude_value =</span> <span class="st">&quot;as_new_rank&quot;</span>)</span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="co">#&gt; $tmatrix</span></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co">#&gt;    </span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="co">#&gt;      1  2  3  4  5  6</span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="co">#&gt;   1 12 14 17 13  5  0</span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="co">#&gt;   2  1  4  3  4  1  0</span></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="co">#&gt;   3  2  0  0  0 11  0</span></span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="co">#&gt;   4  1  2  0  1  2  6</span></span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="co">#&gt;   5  4  0  0  1  1  7</span></span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="co">#&gt;   6  2  1  0  2  0  8</span></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="co">#&gt; </span></span>
<span id="cb12-14"><a href="#cb12-14"></a><span class="co">#&gt; $col_x_bounds</span></span>
<span id="cb12-15"><a href="#cb12-15"></a><span class="co">#&gt; exclude_value            0%           20%           40%           60% </span></span>
<span id="cb12-16"><a href="#cb12-16"></a><span class="co">#&gt;           0.0        1701.0       29461.2       45184.8       66060.2 </span></span>
<span id="cb12-17"><a href="#cb12-17"></a><span class="co">#&gt;           80%          100% </span></span>
<span id="cb12-18"><a href="#cb12-18"></a><span class="co">#&gt;       83659.6       99406.0 </span></span>
<span id="cb12-19"><a href="#cb12-19"></a><span class="co">#&gt; </span></span>
<span id="cb12-20"><a href="#cb12-20"></a><span class="co">#&gt; $col_y_bounds</span></span>
<span id="cb12-21"><a href="#cb12-21"></a><span class="co">#&gt; exclude_value            0%           20%           40%           60% </span></span>
<span id="cb12-22"><a href="#cb12-22"></a><span class="co">#&gt;          0.00       1480.00      10664.72      19406.75      28154.18 </span></span>
<span id="cb12-23"><a href="#cb12-23"></a><span class="co">#&gt;           80%          100% </span></span>
<span id="cb12-24"><a href="#cb12-24"></a><span class="co">#&gt;      57525.96     121396.47</span></span>
<span id="cb12-25"><a href="#cb12-25"></a></span>
<span id="cb12-26"><a href="#cb12-26"></a><span class="kw">getTMatrix</span>(<span class="dt">dat =</span> incomeZeroInfMobility, <span class="dt">col_x =</span> <span class="st">&quot;t0&quot;</span>, <span class="dt">col_y =</span> <span class="st">&quot;t5&quot;</span>,</span>
<span id="cb12-27"><a href="#cb12-27"></a>           <span class="dt">type =</span> <span class="st">&quot;relative&quot;</span>, <span class="dt">num_ranks =</span> <span class="dv">5</span>, <span class="dt">probs =</span> <span class="ot">FALSE</span>,</span>
<span id="cb12-28"><a href="#cb12-28"></a>           <span class="dt">exclude_value =</span> <span class="dv">0</span>, <span class="dt">rerank_exclude_value =</span> <span class="st">&quot;as_existing_rank&quot;</span>)</span>
<span id="cb12-29"><a href="#cb12-29"></a><span class="co">#&gt; $tmatrix</span></span>
<span id="cb12-30"><a href="#cb12-30"></a><span class="co">#&gt;    </span></span>
<span id="cb12-31"><a href="#cb12-31"></a><span class="co">#&gt;      1  2  3  4  5</span></span>
<span id="cb12-32"><a href="#cb12-32"></a><span class="co">#&gt;   1 31 20 17  6  0</span></span>
<span id="cb12-33"><a href="#cb12-33"></a><span class="co">#&gt;   2  2  0  0 11  0</span></span>
<span id="cb12-34"><a href="#cb12-34"></a><span class="co">#&gt;   3  3  0  1  2  6</span></span>
<span id="cb12-35"><a href="#cb12-35"></a><span class="co">#&gt;   4  4  0  1  1  7</span></span>
<span id="cb12-36"><a href="#cb12-36"></a><span class="co">#&gt;   5  3  0  2  0  8</span></span>
<span id="cb12-37"><a href="#cb12-37"></a><span class="co">#&gt; </span></span>
<span id="cb12-38"><a href="#cb12-38"></a><span class="co">#&gt; $col_x_bounds</span></span>
<span id="cb12-39"><a href="#cb12-39"></a><span class="co">#&gt; exclude_value            0%           20%           40%           60% </span></span>
<span id="cb12-40"><a href="#cb12-40"></a><span class="co">#&gt;           0.0        1701.0       29461.2       45184.8       66060.2 </span></span>
<span id="cb12-41"><a href="#cb12-41"></a><span class="co">#&gt;           80%          100% </span></span>
<span id="cb12-42"><a href="#cb12-42"></a><span class="co">#&gt;       83659.6       99406.0 </span></span>
<span id="cb12-43"><a href="#cb12-43"></a><span class="co">#&gt; </span></span>
<span id="cb12-44"><a href="#cb12-44"></a><span class="co">#&gt; $col_y_bounds</span></span>
<span id="cb12-45"><a href="#cb12-45"></a><span class="co">#&gt; exclude_value            0%           20%           40%           60% </span></span>
<span id="cb12-46"><a href="#cb12-46"></a><span class="co">#&gt;          0.00       1480.00      10664.72      19406.75      28154.18 </span></span>
<span id="cb12-47"><a href="#cb12-47"></a><span class="co">#&gt;           80%          100% </span></span>
<span id="cb12-48"><a href="#cb12-48"></a><span class="co">#&gt;      57525.96     121396.47</span></span>
<span id="cb12-49"><a href="#cb12-49"></a></span>
<span id="cb12-50"><a href="#cb12-50"></a><span class="kw">getTMatrix</span>(<span class="dt">dat =</span> incomeZeroInfMobility, <span class="dt">col_x =</span> <span class="st">&quot;t0&quot;</span>, <span class="dt">col_y =</span> <span class="st">&quot;t5&quot;</span>,</span>
<span id="cb12-51"><a href="#cb12-51"></a>           <span class="dt">type =</span> <span class="st">&quot;relative&quot;</span>, <span class="dt">num_ranks =</span> <span class="dv">5</span>, <span class="dt">probs =</span> <span class="ot">FALSE</span>,</span>
<span id="cb12-52"><a href="#cb12-52"></a>           <span class="dt">exclude_value =</span> <span class="dv">0</span>, <span class="dt">rerank_exclude_value =</span> <span class="st">&quot;exclude&quot;</span>)</span>
<span id="cb12-53"><a href="#cb12-53"></a><span class="co">#&gt; $tmatrix</span></span>
<span id="cb12-54"><a href="#cb12-54"></a><span class="co">#&gt;    </span></span>
<span id="cb12-55"><a href="#cb12-55"></a><span class="co">#&gt;      1  2  3  4  5</span></span>
<span id="cb12-56"><a href="#cb12-56"></a><span class="co">#&gt;   1  4  3  4  1  0</span></span>
<span id="cb12-57"><a href="#cb12-57"></a><span class="co">#&gt;   2  0  0  0 11  0</span></span>
<span id="cb12-58"><a href="#cb12-58"></a><span class="co">#&gt;   3  2  0  1  2  6</span></span>
<span id="cb12-59"><a href="#cb12-59"></a><span class="co">#&gt;   4  0  0  1  1  7</span></span>
<span id="cb12-60"><a href="#cb12-60"></a><span class="co">#&gt;   5  1  0  2  0  8</span></span>
<span id="cb12-61"><a href="#cb12-61"></a><span class="co">#&gt; </span></span>
<span id="cb12-62"><a href="#cb12-62"></a><span class="co">#&gt; $col_x_bounds</span></span>
<span id="cb12-63"><a href="#cb12-63"></a><span class="co">#&gt; exclude_value            0%           20%           40%           60% </span></span>
<span id="cb12-64"><a href="#cb12-64"></a><span class="co">#&gt;           0.0        1701.0       29461.2       45184.8       66060.2 </span></span>
<span id="cb12-65"><a href="#cb12-65"></a><span class="co">#&gt;           80%          100% </span></span>
<span id="cb12-66"><a href="#cb12-66"></a><span class="co">#&gt;       83659.6       99406.0 </span></span>
<span id="cb12-67"><a href="#cb12-67"></a><span class="co">#&gt; </span></span>
<span id="cb12-68"><a href="#cb12-68"></a><span class="co">#&gt; $col_y_bounds</span></span>
<span id="cb12-69"><a href="#cb12-69"></a><span class="co">#&gt; exclude_value            0%           20%           40%           60% </span></span>
<span id="cb12-70"><a href="#cb12-70"></a><span class="co">#&gt;          0.00       1480.00      10664.72      19406.75      28154.18 </span></span>
<span id="cb12-71"><a href="#cb12-71"></a><span class="co">#&gt;           80%          100% </span></span>
<span id="cb12-72"><a href="#cb12-72"></a><span class="co">#&gt;      57525.96     121396.47</span></span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
